<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>NNITRO OS | STABLE</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        body { background: #000; color: #4ceb34; font-family: 'Courier New', monospace; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        #chat { flex: 1; overflow-y: auto; padding: 20px; border-bottom: 1px solid #4ceb34; }
        .input-bar { display: flex; padding: 10px; background: #0a0a0a; }
        input { background: #000; border: 1px solid #4ceb34; color: #4ceb34; padding: 10px; flex: 1; outline: none; }
        button { background: #4ceb34; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; margin-left: 5px; }
        .msg { margin-bottom: 10px; border-left: 2px solid #4ceb34; padding-left: 10px; }
        #setup-alert { color: red; text-align: center; padding: 20px; border: 2px solid red; display: none; }
    </style>
</head>
<body>

<div id="setup-alert">ОШИБКА: ВСТАВЬ КЛЮЧИ В КОД ФАЙЛА!</div>

<div id="chat"></div>

<div class="input-bar">
    <input type="text" id="target" style="max-width: 100px;" placeholder="КОМУ">
    <input type="text" id="msg" placeholder="СООБЩЕНИЕ...">
    <button onclick="send()">ОТПРАВИТЬ</button>
</div>

<script>
    // === ВСТАВЬ СВОИ ДАННЫЕ СЮДА (МЕЖДУ КАВЫЧЕК) ===
    const firebaseConfig = {
        apiKey: "ТВОЙ_API_KEY",
        databaseURL: "ТВОЙ_URL_БАЗЫ",
        projectId: "ТВОЙ_PROJECT_ID",
        storageBucket: "",
        messagingSenderId: "",
        appId: ""
    };
    // ==============================================

    // Проверка, заполнил ли ты данные
    if (firebaseConfig.apiKey === "ТВОЙ_API_KEY") {
        document.getElementById('setup-alert').style.display = 'block';
    } else {
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const myNick = localStorage.getItem('nn_nick') || prompt("Твой ник для входа:");
        if (myNick) localStorage.setItem('nn_nick', myNick);

        // Слушаем новые сообщения
        db.ref('messages').limitToLast(50).on('child_added', (snap) => {
            const data = snap.val();
            if (data.to === myNick || data.from === myNick) {
                const div = document.createElement('div');
                div.className = 'msg';
                div.innerHTML = `<b>[${data.from} -> ${data.to}]:</b> ${data.text}`;
                document.getElementById('chat').appendChild(div);
                document.getElementById('chat').scrollTop = 99999;
            }
        });
    }

    function send() {
        const to = document.getElementById('target').value;
        const text = document.getElementById('msg').value;
        const from = localStorage.getItem('nn_nick');
        if (to && text) {
            firebase.database().ref('messages').push({ from, to, text });
            document.getElementById('msg').value = '';
        }
    }
</script>
</body>
</html>